name: Manueller Cleanup Workflow

on: workflow_dispatch

jobs:
    cleanup:
        runs-on: ubuntu-latest
        steps:
            - name: ssh setup
              run: | 
                mkdir -p ~/.ssh
                echo "${{secrets.SSH_PRIVATE_KEY}}" > ~/.ssh/meinPrivateKey
                chmod 400 ~/.ssh/meinPrivateKey
                ssh-keyscan -H ${{secrets.EC2_IP}}  >> ~/.ssh/known_hosts  

            - name: cleanup
              run: |
                ssh -i ~/.ssh/meinPrivateKey ubuntu@${{secrets.EC2_IP}} "
                docker stop mein-frontend-container || true 
                docker rm mein-frontend-container || true
                docker rmi frontend-image || true
                "